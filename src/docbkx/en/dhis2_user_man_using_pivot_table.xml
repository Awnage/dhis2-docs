<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN" "http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd" []>
<chapter>
  <title>Using Pivot
    <?oxy_comment_start author="Home" timestamp="20160406T133408+0200" comment="I haven&apos;t changed from UK to US spelling. Pending implementation decision. [Cecilia 6 Apr 2016]]"?>Table<?oxy_comment_end?>
    app</title>
  <section>
    <title>Pivot table
      <?oxy_comment_start author="Home" timestamp="20160406T132638+0200" comment=" Look into revising title, should have a common structure with other topics. (Action for tech writer) [Cecilia 6 Apr 2016]"?>overview<?oxy_comment_end?></title>
    <para>With the pivot table app you can create pivot tables
      <?oxy_comment_start author="Home" timestamp="20160406T132919+0200" comment="Question for dev: &quot;based on&quot; instead of &quot;using&quot;? (Cecilia, 6 Apr 2016)"?>using<?oxy_comment_end?>
      all available data dimensions in DHIS 2. A pivot table is a dynamic tool for data analysis
      which lets you summarize and arrange data according to its dimensions. Examples of data
      dimensions in DHIS 2 are:<itemizedlist>
        <listitem>
          <para>data dimension itself (for example data elements, indicators and events)</para>
        </listitem>
        <listitem>
          <para>periods (representing the time period for which the data
            <?oxy_comment_start author="Home" timestamp="20160406T133122+0200" comment="What does &quot;represents&quot; mean here? Clarification needed."?>represents<?oxy_comment_end?>)</para>
        </listitem>
        <listitem>
          <para>organisational hierarchy (representing the geographical location of the data)</para>
        </listitem>
      </itemizedlist></para>
    <para>From these dimensions you can freely select dimension <emphasis role="italic"
        >items</emphasis> to include in the pivot table. You can create additional dimensions in
      DHIS 2 with the
      <?oxy_comment_start author="Home" timestamp="20160406T133539+0200" comment="What is the exact name of this function in the UI?"?>group
      set functionality<?oxy_comment_end?>.
      T<?oxy_comment_start author="Home" timestamp="20160406T133642+0200" comment="How do you do this?"?>his
      allows for different aggregation pathways, such as aggregation by &quot;Partner&quot; or
      facility type. <?oxy_comment_end?></para>
    <para>A pivot table
      <?oxy_comment_start author="Home" timestamp="20160406T133748+0200" comment="Do you always have all three dimesnions?

Revise phrase to &quot;A pivot table arranges data...&quot; = correct?"?>can
      arrange data dimensions on <emphasis role="italic">columns</emphasis>, <emphasis role="italic"
        >rows</emphasis>, and as <emphasis role="italic">filters<?oxy_comment_end?></emphasis>. When
      you place a data dimension on columns, the pivot table will display one column per dimension
      item. If you place multiple data dimensions on columns, the pivot table displays one column
      for all combinations of the items in the selected dimensions. When you place a data dimension
      on rows, the pivot table displays one row per dimension item in a similar fashion. The
      dimensions you select as filters will not be included in the pivot table, but will aggregate
      and filter the table data based on the selected filter items.</para>
  </section>
  <section>
    <title>Creating a new pivot table</title>
    <para>The workflow for creating a new pivot table is:</para>
    <orderedlist>
      <listitem>
        <para>In the <emphasis role="bold">Apps</emphasis> menu, click <emphasis role="bold">Pivot
            Table</emphasis>.</para>
        <para>The <emphasis role="bold">DHIS 2 Pivot Table</emphasis> window opens.</para>
      </listitem>
      <listitem>
        <para>In the
          <?oxy_comment_start author="Home" timestamp="20160406T140229+0200" comment="Must define the names of the different areas of the UI."?>menu
          to the left<?oxy_comment_end?>, select the dimension items you want to analyse, for
          example
          <?oxy_comment_start author="Home" timestamp="20160406T140440+0200" comment="Can you only choose elements from the &quot;Data&quot; field?"?>data
          elements or indicators<?oxy_comment_end?>.</para>
      </listitem>
      <listitem>
        <para>Click <emphasis role="bold">Layout</emphasis> and arrange the data dimensions as
          columns, rows and filters. </para>
        <para>You can keep the default
          <?oxy_comment_start author="Home" timestamp="20160406T140808+0200" comment="Revise wording. Use &quot;selection&quot; or maybe settings."?>selection<?oxy_comment_end?>
          if you want.</para>
      </listitem>
      <listitem>
        <para>Click <emphasis role="bold">Update</emphasis>.</para>
        <para>A new pivot table based on your choices
          <?oxy_comment_start author="Home" timestamp="20160406T142809+0200" comment="Check terminology.
Occurs maybe?"?>displays<?oxy_comment_end?>.</para>
      </listitem>
    </orderedlist>
    <example>
      <title>Pivot table based on the demo database.</title>
      <para>Notice how indicators are listed on columns and periods as rows.</para>
      <screenshot>
        <screeninfo>Example pivot table with data elements on columns and periods as
          rows.</screeninfo>
        <mediaobject>
          <imageobject>
            <imagedata width="80%" align="center"
              fileref="resources/images/pivot_table/basic_pivot.png" format="PNG"/>
          </imageobject>
        </mediaobject>
      </screenshot>
    </example>
    <para>Related topics:</para>
    <itemizedlist>
      <listitem>
        <para>For more information about how you select dimension
          items,<?oxy_comment_start author="Home" timestamp="20160406T155623+0200" comment="How do you insert a x-ref?
Help needed. 
See screenshot in word file for error message."?>
          see .<?oxy_comment_end?></para>
      </listitem>
      <listitem>
        <para>For more information about the pivot table layout, see .</para>
      </listitem>
    </itemizedlist>
    <section>
      <title>Selecting dimension
        <?oxy_comment_start author="Home" timestamp="20160406T163208+0200" comment="Review this section.
Items in list must correspond to explaintions below. Now they&apos;re not corresponding.
Consider presenting content in a table."?>items<?oxy_comment_end?></title>
      <para>The left menu lists sections for all available data dimensions. From each section you
        can select any number of dimension items. As an example, you can open the section for data
        elements and select any number of data elements from the available list. You can select an
        item by marking it and clicking on the arrow in the section header or simply double-clicking
        on the item. Before you can use a data dimension in your pivot table you must at least
        select one dimension item. If you arrange a dimension as columns or rows but do not select
        any dimension items, the dimension is ignored.</para>
      <para>You must choose at least one
        <?oxy_comment_start author="Home" timestamp="20160406T163002+0200" comment="Member?
"?>member<?oxy_comment_end?>
        of the data dimension to create a pivot table. The available types are:</para>
      <para>
        <itemizedlist>
          <listitem>
            <para>Indicators</para>
          </listitem>
          <listitem>
            <para>Data elements</para>
          </listitem>
          <listitem>
            <?oxy_custom_start type="oxy_content_highlight" color="255,255,0"?>
            <para>Data sets </para>
            <itemizedlist>
              <listitem>
                <para>Reporting rates</para>
                <para>The actual number of reports devided with the expected number of
                  reports.</para>
              </listitem>
              <listitem>
                <para>Actual reports</para>
              </listitem>
              <listitem>
                <para>Expected reports</para>
              </listitem>
            </itemizedlist>
          </listitem>
          <?oxy_custom_end?>
          <listitem>
            <para>Event data items</para>
          </listitem>
          <listitem>
            <para>Program indicators</para>
          </listitem>
        </itemizedlist>
      </para>
      <para>You can combine these dimensions to display for example aggregate data with reporting
        rates, or event data items together with program indicators, all in the same pivot tables.
        For the &quot;data element&quot; data dimension, you are also able to select
        &quot;Totals&quot; and &quot;Details&quot;, which will allow you to view different category
        combination options together on the same pivot table. </para>
      <para>For the period dimension you can choose between using fixed periods or relative periods.
        An example of a fixed period is &quot;January 2012&quot;. To select fixed periods start by
        selecting a period type from the period type list. You can then select periods from the list
        of available periods. </para>
      <para>Relative periods are periods relative to the current date. Examples of relative periods
        are &quot;Last month&quot;, &quot;Last 12 months&quot;, &quot;Last 5 years&quot;. Relative
        periods can be selected by ticking the check-boxes next to each period. The main advantage
        of using relative periods is that when you save a pivot table favorite, it will stay updated
        with the latest data as time goes by without the need for constantly updating it.</para>
      <para>For the organisation unit dimension you can select any number of organisation units from
        the hierarchy. To select all organisation units below a specific parent organisation unit,
        right click and click &quot;Select all children&quot;. To manually select multiple
        organisation units, click and hold the <emphasis role="bold">Ctrl</emphasis> key while
        clicking on organisation units. You can tick &quot;User org unit&quot;, &quot;User
        sub-units&quot; or &quot;User sub-x2-units&quot; in order to dynamically insert the
        organisation unit or units associated with your user account. This is useful when you save a
        pivot table favorite and want to share it with other users, as the organisation units linked
        with the other user&apos;s account will be used when viewing the favorite.</para>
      <screenshot>
        <screeninfo>Selection of fixed and relative periods.</screeninfo>
        <mediaobject>
          <imageobject>
            <imagedata width="80%" align="center"
              fileref="resources/images/pivot_table/period_dimension.png" format="PNG" scale="80"/>
          </imageobject>
        </mediaobject>
      </screenshot>
      <para>Dynamic dimensions can consist of organisation unit group sets, data element group sets,
        or category option group sets which have been configured with the type of
        &quot;Disaggregation&quot;. Once the group sets have been configured, they will be come
        available in the pivot tables, and can be used as additional analysis dimensions, for
        instance to analyze aggregate data by Type of organisational unit or Implementing partner.
        Dynamic dimensions work the same as fixed dimensions. </para>
      <tip>
        <para>Some dynamic dimensions may contain many
          <?oxy_comment_start author="Home" timestamp="20160407T165624+0200" comment="Revise choice of word. What does member mean in this context?"?>members<?oxy_comment_end?>.
          This can cause issues with certain browsers due to the length of the URL when many
          dimension members are selected. A special &quot;All&quot; checkbox is available for
          dynamic dimensions, which allows you to include all available dimensions implicitly in
          your pivot table, without specifying each and every dimension member.</para>
      </tip>
    </section>
    <section>
      <title>Modifying pivot table
        <?oxy_comment_start author="Home" timestamp="20160406T162540+0200" comment="Would you modify the layout often? Or is it more or less set once you have saved the table as a favorite?"?>layout<?oxy_comment_end?></title>
      <para>After selecting data dimensions it is time to arrange your pivot table. Click
        &quot;Layout&quot; in the top menu to open the layout screen. In this screen you can
        position your data dimensions as table columns, rows or filters by clicking and dragging the
        dimensions from the dimensions list to the respective column, row and filter lists. You can
        set any number of dimensions in any of the lists. For instance, you can click on
        &quot;Organisation units&quot; and drag it to the row list in order to position the
        organisation unit dimension as table rows. Note that indicators, data elements and data set
        reporting rates are part of the common &quot;Data&quot; dimension and will be displayed
        together in the pivot table. For instance, after selecting indicators and data elements in
        the left menu, you can drag &quot;Organisation Unit&quot; from the available dimensions list
        to the row dimension list in order to arrange them as rows in the pivot table.</para>
      <screenshot>
        <screeninfo>The table layout screen.</screeninfo>
        <mediaobject>
          <imageobject>
            <imagedata width="40%" align="center"
              fileref="resources/images/pivot_table/table_layout.png" format="PNG" scale="90"/>
          </imageobject>
        </mediaobject>
      </screenshot>
      <para>After you have set up your pivot table you can click &quot;Update&quot; to render your
        pivot table, or click &quot;Hide&quot; to hide the layout screen without any changes taking
        effect. Since we in our example have selected both the period and organisation unit
        dimension as rows, the pivot table will generate all combinations of the items in these
        dimensions and produce a table like this:</para>
      <screenshot>
        <screeninfo>Pivot table where organisation units and periods are repeated on
          rows.</screeninfo>
        <mediaobject>
          <imageobject>
            <imagedata width="80%" align="center"
              fileref="resources/images/pivot_table/pivot_rows.png" format="PNG"/>
          </imageobject>
        </mediaobject>
      </screenshot>
    </section>
  </section>
  <section>
    <title>Using
      <?oxy_comment_start author="Home" timestamp="20160406T164035+0200" comment="Question for dev:
What&apos;s the main purpose with these functions?

Changing the look and feel of the table?

Consider changing title to &quot; Modifying table settings&quot;, ev Modifying table options"?>table
      options<?oxy_comment_end?></title>
    <para>To change the pivot table settings:</para>
    <orderedlist>
      <listitem>
        <para>Click <emphasis role="bold">Options</emphasis>.</para>
        <para>The <emphasis role="bold">TABLE OPTIONS</emphasis> dialog box opens.</para>
      </listitem>
      <listitem>
        <para>Set the
          <?oxy_comment_start author="Home" timestamp="20160406T165443+0200" comment="Why these options?"?>options<?oxy_comment_end?>
          as required.</para>
        <table frame="all">
          <title>Table options</title>
          <tgroup cols="2">
            <colspec colname="c1" colnum="1" colwidth="1*"/>
            <colspec colname="c2" colnum="2" colwidth="1.5*"/>
            <thead>
              <row>
                <entry><?oxy_comment_start author="Home" timestamp="20160406T170516+0200" comment="Must update this list. More settings in GUI."?>Option<?oxy_comment_end?></entry>
                <entry>Description</entry>
              </row>
            </thead>
            <tbody>
              <row>
                <entry>
                  <para><emphasis role="bold">Show column totals</emphasis></para>
                  <para><emphasis role="bold">Show row totals</emphasis></para>
                </entry>
                <entry>
                  <para>Displays total values in the table for each row and column, as well as a
                    grand total for all values in the table.</para>
                </entry>
              </row>
              <row>
                <entry>
                  <para><emphasis role="bold">Show column sub-totals</emphasis></para>
                  <para><emphasis role="bold">Show row sub-totals</emphasis></para>
                </entry>
                <entry>
                  <para>Displays subtotals in the table for each dimension. In the screenshot above,
                    notice how subtotals are generated for each of the periods in the period
                    dimension. Note that subtotals will be hidden for columns or rows if there is
                    only one selected dimension, as the values in that case are equal to the
                    subtotals.</para>
                </entry>
              </row>
              <row>
                <entry>
                  <para><emphasis role="bold">Show dimension labels</emphasis></para>
                </entry>
                <entry>
                  <para>Shows the dimension names as part of the pivot tables.</para>
                </entry>
              </row>
              <row>
                <entry>
                  <para><emphasis role="bold">Hide empty rows</emphasis></para>
                </entry>
                <entry>
                  <para>Hides empty rows from the table, which is useful when looking at large
                    tables where a big part of the dimension items do not have data in order to keep
                    the table more readable.</para>
                </entry>
              </row>
              <row>
                <entry>
                  <para><emphasis role="bold">Skip Rounding</emphasis></para>
                </entry>
                <entry>
                  <para>Skips the rounding of data values, offering the full precision of data
                    values. Can be useful for finance data where the full dollar amount is
                    required.</para>
                </entry>
              </row>
              <row>
                <entry>
                  <para><emphasis role="bold">Aggregation type</emphasis></para>
                </entry>
                <entry>
                  <para>The default aggregation operator can be over-ridden here, by selecting a
                    different aggregation operator. Some of the aggregation types are <emphasis
                      role="bold">Count</emphasis>, <emphasis role="bold">Min</emphasis> and
                      <emphasis role="bold">Max</emphasis>.</para>
                </entry>
              </row>
              <row>
                <entry>
                  <para><emphasis role="bold">Show hierarchy</emphasis></para>
                </entry>
                <entry>
                  <para>Shows the name of all ancestors for organisation units, for example "Sierra
                    Leone / Bombali / Tamabaka / Sanya CHP&quot; for Sanya CHP. The organisation
                    units are then sorted alphabetically which will order the organisation units
                    perfectly according to the hierarchy.</para>
                </entry>
              </row>
              <row>
                <entry>
                  <para><emphasis role="bold">Include only completed events</emphasis></para>
                </entry>
                <entry>
                  <para>Includes only completed events in the aggregation process. This is useful
                    for example to exclude partial events in indicator calculations.</para>
                </entry>
              </row>
              <row>
                <entry>
                  <para><emphasis role="bold">Display density</emphasis></para>
                </entry>
                <entry>
                  <para>Controls the size of the cells in the table. You can set it to
                    &quot;comfortable&quot;, &quot;normal&quot; and &quot;compact&quot;. </para>
                  <para>The &quot;compact&quot; option is handy in order to fit large tables into
                    the browser screen.</para>
                </entry>
              </row>
              <row>
                <entry>
                  <para><emphasis role="bold">Font size</emphasis></para>
                </entry>
                <entry>
                  <para>Controls the size of the table text font. Can be set to &quot;large&quot;,
                    &quot;normal&quot; and &quot;small&quot;.</para>
                </entry>
              </row>
              <row>
                <entry>
                  <para><emphasis role="bold">Digit group separator</emphasis></para>
                </entry>
                <entry>
                  <para>Controls which character to separate groups of digits or
                    &quot;thousands&quot;. Can be set to &quot;comma&quot;, &quot;space&quot; and
                    &quot;none&quot;.</para>
                </entry>
              </row>
              <row>
                <entry>
                  <para><emphasis role="bold">Legend set</emphasis></para>
                </entry>
                <entry>
                  <para>Shows a color indicator next to the values. Currently the GIS legend sets
                    are being used.</para>
                </entry>
              </row>
            </tbody>
          </tgroup>
        </table>
      </listitem>
      <listitem>
        <para>Click <emphasis role="bold">Update</emphasis>.</para>
        <para>The new pivot table
          <?oxy_comment_start author="Home" timestamp="20160406T170323+0200" comment="Check terminology. Must use standardized verb (generate, display, create...?)"?>generates<?oxy_comment_end?>.</para>
      </listitem>
    </orderedlist>
  </section>
  <section>
    <title>Managing favorites</title>
    <section>
      <title>Saving a pivot table as favorite</title>
      <para>When you have created a pivot table it is convenient to save it as a favorite: </para>
      <orderedlist>
        <listitem>
          <para>Click <emphasis role="bold">Favorites</emphasis> > <emphasis role="bold">Save
              as</emphasis>.</para>
          <para>The <emphasis role="bold">SAVE FAVORITE AS</emphasis> dialog box opens.</para>
        </listitem>
        <listitem>
          <para>In the text field, type the name you want to give your pivot table.</para>
        </listitem>
        <listitem>
          <para>Click <emphasis role="bold">Save</emphasis>.</para>
        </listitem>
      </orderedlist>
    </section>
    <section>
      <title>Opening a favorite</title>
      <orderedlist>
        <listitem>
          <para>Click <emphasis role="bold">Favorites</emphasis> > <emphasis role="bold"
              >Open</emphasis>.</para>
          <para>The <emphasis role="bold">OPEN FAVORITE</emphasis> dialog box opens.</para>
        </listitem>
        <listitem>
          <para>Find the favorite you want to open. You can either use <emphasis role="bold"
              >Prev</emphasis> and <emphasis role="bold">Next</emphasis> or the search field to find
            a saved favorite.</para>
        </listitem>
        <listitem>
          <para>C<?oxy_comment_start author="Home" timestamp="20160407T143714+0200" comment="Verify vocabulary: click on or click?"?>lick<?oxy_comment_end?>
            the name</para>
          <?oxy_comment_start author="Home" timestamp="20160407T143856+0200" comment="Necessary to include the result?"?>
          <para>The selected favorite opens.</para>
          <?oxy_comment_end?>
        </listitem>
      </orderedlist>
    </section>
    <section>
      <title>Renaming a favorite</title>
      <orderedlist>
        <listitem>
          <para>Click <emphasis role="bold">Favorites</emphasis> > <emphasis role="bold"
              >Rename</emphasis>.</para>
          <para>The <emphasis role="bold">RENAME FAVORITE</emphasis> dialog box opens.</para>
        </listitem>
        <listitem>
          <para>In the text field, type the new name you want to give your pivot table.</para>
        </listitem>
        <listitem>
          <para>Click <emphasis role="bold">Rename</emphasis>.</para>
        </listitem>
      </orderedlist>
    </section>
    <section>
      <title>Sharing a favorite</title>
      <para>After you have created a pivot table and saved it as a favorite, you can share the pivot
        table with everyone or a user group: </para>
      <para>
        <orderedlist>
          <listitem>
            <para>Click <emphasis role="bold">Favorites</emphasis> > <emphasis role="bold"
                >Share</emphasis>.</para>
            <para>The <emphasis role="bold">SHARING SETTINGS</emphasis> dialog box opens.</para>
          </listitem>
          <listitem>
            <para>In the text field, type the name of the user group you want to share your favorite
              with and click the <emphasis role="bold">+</emphasis> icon.</para>
            <para>The chosen user group is added to the list of recipients. </para>
            <para>Repeat the step to add more user groups. </para>
          </listitem>
          <listitem>
            <para>If you want to allow external access, select the corresponding box.</para>
          </listitem>
          <listitem>
            <para>For each user group, choose an
              <?oxy_comment_start author="Home" timestamp="20160407T150433+0200" comment="Correct term?"?>access
              setting<?oxy_comment_end?>. The options are:</para>
            <itemizedlist>
              <listitem>
                <para><?oxy_comment_start author="Home" timestamp="20160407T150510+0200" comment="Why is this option only available for Public access?"?>None<?oxy_comment_end?></para>
              </listitem>
              <listitem>
                <para>Can view</para>
              </listitem>
              <listitem>
                <para>Can view and edit</para>
              </listitem>
            </itemizedlist>
          </listitem>
          <listitem>
            <para>Click <emphasis role="bold">Save</emphasis>.</para>
          </listitem>
        </orderedlist>
      </para>
    </section>
    <section>
      <title>Sharing an interpretation of a favorite</title>
      <para role="">For
        <?oxy_comment_start author="Home" timestamp="20160407T151353+0200" comment="Which ones?"?>certain<?oxy_comment_end?>
        analysis-related resources in DHIS 2, you can share a data interpretation. An interpretation
        is a link to the relevant resource together with a text expressing some insight about the
        data. </para>
      <para role="">To create an interpretation of a pivot table and share it with all users of the
        system:</para>
      <orderedlist>
        <listitem>
          <para>Click <emphasis role="bold">Favorites</emphasis> > <emphasis role="bold">Write
              interpretation</emphasis>.</para>
          <para>The <emphasis role="bold">WRITE INTERPRETATION</emphasis> dialog box opens.</para>
        </listitem>
        <listitem>
          <para>In the text field, type a comment, question or interpretation.</para>
        </listitem>
        <listitem>
          <para>Click <emphasis role="bold">Share</emphasis>.</para>
          <para>The dialog box closes automatically. You can see the interpretation on the <emphasis
              role="bold">Dashboard</emphasis>.</para>
        </listitem>
      </orderedlist>
    </section>
    <section>
      <title>Creating a link to a favorite</title>
      <para>
        <orderedlist>
          <listitem>
            <para>Click <emphasis role="bold">Favorites</emphasis> > <emphasis role="bold">Get
                link</emphasis>.</para>
            <para>The <emphasis role="bold">FAVORITE LINK</emphasis> window opens.</para>
          </listitem>
          <listitem>
            <para>Click the type of link you need.</para>
            <itemizedlist>
              <listitem>
                <para><emphasis role="bold">Open in this app</emphasis>: Provides a URL for the
                  favorite. You can use this link to share the favorite with other users or
                  colleagues via email or chat.</para>
              </listitem>
              <listitem>
                <para><emphasis role="bold">Open in web api</emphasis>: Provides a URL of the API
                  resource. By default this is a HTML resource, but you can modify the suffix of
                  &quot;.html&quot; to &quot;.json&quot; or &quot;.csv&quot;. Other data types are
                  available. This option is most useful when you need an API link to the pivot table
                  resource. Consult the DHIS2
                  <?oxy_comment_start author="Home" timestamp="20160407T154520+0200" comment="Link to correct document should be inserted here."?>developers<?oxy_comment_end?>
                  guide for details about the different types which are available.</para>
              </listitem>
            </itemizedlist>
          </listitem>
          <listitem>
            <para>Click <emphasis role="bold">x</emphasis> to close the window.</para>
          </listitem>
        </orderedlist>
      </para>
    </section>
    <section>
      <title>Deleting a favorite</title>
      <para>
        <orderedlist>
          <listitem>
            <para>Click <emphasis role="bold">Favorites</emphasis> > <emphasis role="bold"
                >Delete</emphasis>.</para>
            <para>A dialog box opens.</para>
          </listitem>
          <listitem>
            <para>Click <emphasis role="bold">Delete</emphasis> to confirm your choice.</para>
          </listitem>
        </orderedlist>
      </para>
    </section>
  </section>
  <section>
    <title>Downloading data from a pivot table</title>
    <section>
      <title>Downloading table layout data format</title>
      <para>To download the data in the current pivot table: </para>
      <orderedlist>
        <listitem>
          <para>Click <emphasis role="bold">Download</emphasis>.</para>
        </listitem>
        <listitem>
          <para>Under <emphasis role="bold">Table layout</emphasis>, click the format you want to
            download: Microsoft Excel, CSV or HTML.</para>
          <para>The data table will have one column per dimension and contain names of the dimension
            items. </para>
        </listitem>
      </orderedlist>
      <tip>
        <para>You can
          <?oxy_comment_start author="Home" timestamp="20160408T095627+0200" comment="Instructions on how to use a different application should not be here. Remove ok?"?>easily<?oxy_comment_end?>
          create a pivot table in <?oxy_comment_start author="Home" timestamp="20160408T095906+0200" comment="Microsoft is a registered trademark, it must be marked in applications and user docs.
Refer to: https://www.microsoft.com/en-us/legal/intellectualproperty/trademarks/usage/general.aspx"?>Microsoft<?oxy_comment_end?>
          <?oxy_comment_start author="Home" timestamp="20160408T095959+0200" comment="Excel is a registered trademark, it must be marked in applications and user docs.
Refer to: https://www.microsoft.com/en-us/legal/intellectualproperty/trademarks/en-us.aspx#941ec897-4e24-4d80-8b94-47f4122a241b
"?>Excel<?oxy_comment_end?>
          from the downloaded Excel file by clicking on &quot;pivot table&quot; in the top panel,
          then clicking on &quot;create pivot table&quot;, then marking the data range in the
          spreadsheet before clicking &quot;OK&quot;.u can.</para>
      </tip>
    </section>
    <section>
      <title>Downloading plain data source format</title>
      <para>You can download data in the current pivot table in JSON, XML, Excel, and CSV as plain
        data formats with different identification schemes (ID, Code, and Name). The data document
        uses identifiers of the dimension items and opens in a new browser window to display the URL
        of the request to the Web API in the address bar. This is useful for developers of apps and
        other client modules based on the DHIS 2 Web API or for those who require a plan data
        source, for instance for import into statistical packages.</para>
      <para>To download plain data source formats:</para>
      <orderedlist>
        <listitem>
          <para>Click <emphasis role="bold">Download</emphasis>.</para>
        </listitem>
        <listitem>
          <para>Under <emphasis role="bold">Plain data source</emphasis>, click the format you want
            to download.</para>
          <para>
            <table frame="all">
              <title>Available
                <?oxy_comment_start author="Home" timestamp="20160408T102014+0200" comment="What is the ID, Code and Name used for?
Are the downloaded files different from the &quot;main&quot; file?

Information from Lars:
Main file downloads the ID data. "?>formats<?oxy_comment_end?></title>
              <tgroup cols="3">
                <colspec colname="newCol1" colnum="1" colwidth="1*"/>
                <colspec colname="c1" colnum="2" colwidth="1.83*"/>
                <colspec colname="c2" colnum="3" colwidth="2.6*"/>
                <thead>
                  <row>
                    <entry>
                      <para>Format</para>
                    </entry>
                    <entry>
                      <para>Action</para>
                    </entry>
                    <entry>
                      <para>Description</para>
                    </entry>
                  </row>
                </thead>
                <tbody>
                  <row>
                    <entry>
                      <para>JSON</para>
                    </entry>
                    <entry>
                      <para>Click <emphasis role="bold">JSON</emphasis></para>
                    </entry>
                    <entry>
                      <para>Downloads JSON format based on ID property. </para>
                      <para>You can also download JSON format based on <emphasis role="bold"
                          >Code</emphasis> or <emphasis role="bold">Name</emphasis> property.
                      </para>
                    </entry>
                  </row>
                  <row>
                    <entry>
                      <para>XML</para>
                    </entry>
                    <entry>
                      <para>Click <emphasis role="bold">XML</emphasis></para>
                    </entry>
                    <entry>
                      <para>Downloads XML format based on ID property.</para>
                      <para>You can also download XML format based on <emphasis role="bold"
                          >Code</emphasis> or <emphasis role="bold">Name</emphasis> property.
                      </para>
                    </entry>
                  </row>
                  <row>
                    <entry>
                      <para>Microsoft Excel</para>
                    </entry>
                    <entry>
                      <para>Click <emphasis role="bold">Microsoft Excel</emphasis></para>
                    </entry>
                    <entry>
                      <para>Downloads XML format based on ID property.</para>
                      <para>You can also download Microsoft Excel format based on <emphasis
                          role="bold">Code</emphasis> or <emphasis role="bold">Name</emphasis>
                        property.</para>
                    </entry>
                  </row>
                  <row>
                    <entry>
                      <para>CSV</para>
                    </entry>
                    <entry>Click <emphasis role="bold">CSV</emphasis></entry>
                    <entry>
                      <para>Downloads CSV format based on ID property.</para>
                      <para>You can also download CSV format based on <emphasis role="bold"
                          >Code</emphasis> or <emphasis role="bold">Name</emphasis> property.</para>
                    </entry>
                  </row>
                  <row>
                    <entry>
                      <para>JRXML</para>
                    </entry>
                    <entry>
                      <para>Put the cursor on <emphasis role="bold">Advanced</emphasis> and click
                          <emphasis role="bold">JRXML</emphasis></para>
                    </entry>
                    <entry>
                      <para>Produces a template of a Jasper Report which can be further customized
                        based on your exact needs and used as the basis for a standard report in
                        DHIS 2.</para>
                    </entry>
                  </row>
                  <row>
                    <entry>
                      <para>Raw data SQL</para>
                    </entry>
                    <entry>
                      <para>Put the cursor on <emphasis role="bold">Advanced</emphasis> and click
                          <emphasis role="bold">Raw data SQL</emphasis></para>
                    </entry>
                    <entry>
                      <para>Provides the actual SQL statement used to generate the pivot table. You
                        can use it as a data source in a Jasper report, or as the basis for an SQL
                        view.</para>
                    </entry>
                  </row>
                </tbody>
              </tgroup>
            </table>
          </para>
        </listitem>
      </orderedlist>
    </section>
    <section>
      <title>Downloading CSV format without render data in web browser</title>
      <para>You can download data in CSV format directly without first rendering the data in the web
        browser. This will help overcome any constraint in the system settings that has been set in
        regards to the maximum number of analytic records. This lets you download much larger
        batches of data that you can use for later offline analysis. </para>
      <para>To download data in CSV format without first rendering data in the web browser:</para>
      <orderedlist>
        <listitem>
          <para>Click the arrow beside  <emphasis role="bold">Update</emphasis>.</para>
          <mediaobject>
            <imageobject>
              <imagedata align="center" fileref="resources/images/pivot_table/data_dump.png"
                format="PNG"/>
            </imageobject>
          </mediaobject>
        </listitem>
        <listitem>
          <para>Click <emphasis role="bold">CSV</emphasis> to download the format based on ID
            property.</para>
          <para>The file downloads to your computer.</para>
          <para>
            <tip>
              <para>You can also download CSV format based on <emphasis role="bold">Code</emphasis>
                or <emphasis role="bold">Name</emphasis> property.</para>
            </tip>
          </para>
        </listitem>
      </orderedlist>
    </section>
  </section>
  <section>
    <?oxy_comment_start author="Home" timestamp="20160407T162755+0200" comment="Revise title."?>
    <title>Generating HTML fragment to display pivot table in external web page</title>
    <?oxy_comment_end?>
    <para>Certain analysis-related resources in DHIS 2, like pivot tables, charts and maps, can be
      embedded in any web page by using a plugin. You will find more information about the plugins
      in the Web API chapter in the <emphasis>DHIS2 Developer Manual</emphasis>.</para>
    <para>To generate a HTML fragment that you can use to display the pivot table in an external web
      page:</para>
    <para>
      <orderedlist>
        <listitem>
          <para>Click <emphasis role="bold">Embed</emphasis>.</para>
          <para>The <emphasis role="bold">EMBED IN WEB PAGE</emphasis> window opens.</para>
        </listitem>
        <listitem>
          <para>Click <emphasis role="bold">Select</emphasis> to highlight the HTML
            <?oxy_comment_start author="Home" timestamp="20160407T162900+0200" comment="Do you need to copy the script somewhere? Or is this done by the function Select?"?>fragment<?oxy_comment_end?>.</para>
        </listitem>
        <listitem>
          <para>Click <emphasis role="bold">x</emphasis> to close the window.</para>
        </listitem>
      </orderedlist>
    </para>
  </section>
  <section>
    <title>Visualizing pivot table data as a chart or map</title>
    <para>When you have made a pivot table you can switch between pivot table, chart and map
      visualization of your data. </para>
    <section>
      <title>Opening pivot table as a chart</title>
      <orderedlist>
        <listitem>
          <para>Click <emphasis role="bold">Chart</emphasis> > <emphasis role="bold">Open this table
              as chart</emphasis>.</para>
          <para>Your current pivot table opens as a chart.</para>
        </listitem>
      </orderedlist>
      <screenshot>
        <screeninfo>Analysis integration</screeninfo>
        <mediaobject>
          <imageobject>
            <imagedata width="25%" fileref="resources/images/pivot_table/pivot_integration.png"
              format="PNG" scale="100" align="center"/>
          </imageobject>
        </mediaobject>
      </screenshot>
    </section>
    <section>
      <title>Opening pivot table selection as a chart</title>
      <para>If you want to visualize a small part of your pivot table as a chart you can click
        directly on a value in the table instead opening the whole table. </para>
      <orderedlist>
        <listitem>
          <para>In the pivot table, click a value. </para>
          <para>A menu displays.</para>
          <screenshot>
            <screeninfo>Chart integration</screeninfo>
            <mediaobject>
              <imageobject>
                <imagedata width="35%"
                  fileref="resources/images/pivot_table/pivot_integration_table.png" format="PNG"
                  scale="100" align="center"/>
              </imageobject>
            </mediaobject>
          </screenshot>
        </listitem>
        <listitem>
          <para>To verify the selection, hold the cursor over <emphasis role="bold">Open selection
              as chart</emphasis>. The highlighted dimension headers in the table indicate what data
            will be visualized as a chart.</para>
        </listitem>
        <listitem>
          <para>Click <emphasis role="bold">Open selection as chart</emphasis>.</para>
          <para>Your selection opens as a chart.</para>
        </listitem>
      </orderedlist>
    </section>
    <section>
      <title>Opening pivot table as a map</title>
      <orderedlist>
        <listitem>
          <para>Click <emphasis role="bold">Chart</emphasis> > <emphasis role="bold">Open this table
              as map</emphasis></para>
          <para>Your current pivot table opens as a map.</para>
        </listitem>
      </orderedlist>
    </section>
    <section>
      <title>Opening pivot table selection as a map</title>
      <orderedlist>
        <listitem>
          <para>In the pivot table, click a value.</para>
          <para>A menu displays.</para>
        </listitem>
        <listitem>
          <para>Click <emphasis role="bold">Open selection as
              <?oxy_comment_start author="Home" timestamp="20160408T114014+0200" comment="Which are the criterias when this function is available?

Lars will check if function is available."?>map<?oxy_comment_end?></emphasis>.</para>
          <para>Your selection opens as a map. </para>
        </listitem>
      </orderedlist>
    </section>
  </section>
  <section>
    <title>Constraints and tips</title>
    <para>When selecting and arranging dimensions there are a few
      <?oxy_comment_start author="Home" timestamp="20160407T165212+0200" comment="Consider moving to beginning of section. If there are any constraints the user must know them before he/she starts working with the app."?>constraints<?oxy_comment_end?>
      that apply. All of these constraints are
      <?oxy_comment_start author="Home" timestamp="20160407T165324+0200" comment="Validated when?"?>validated<?oxy_comment_end?>
      and the pivot table module will provide feedback if any constraint is violated.</para>
    <itemizedlist>
      <listitem>
        <para>At least one dimension must be selected on columns or rows.</para>
      </listitem>
      <listitem>
        <para>At least one period must be included in the pivot table.</para>
      </listitem>
      <listitem>
        <para>Data element group sets and reporting rates cannot appear in the same pivot
          table.</para>
      </listitem>
      <listitem>
        <para>A table cannot contain more than the maximum number of analytics records which have been specified through the system settings. The maximum number of records could also be constrained by the maximum RAM which is available to your browser. Considering making more smaller tables, instead of one table which displays all of your data elements and indicators together.  </para>
      </listitem>
    </itemizedlist>
    <tip>
      <?oxy_comment_start author="Home" timestamp="20160407T165406+0200" comment="Looks a lot like the information in the last bullet point above, can it be merged?"?>
      <para>Pivot tables in DHIS 2 are limited to a system set parameter, which controls the number
        of data values which can be returned. The reason for this is two fold. First, it would be
        easy to overwhelm the server with a very complicated request for a large pivot table.
        Second, the amount of data which is able to be rendered in a browser is fairly limited. If
        you are having problems with very large or complex tables, consider to try and reduce the
        number of items. It is usually more useful to have smaller, concise tables which are easier
        to understand and which address a particular analysis. </para>
      <?oxy_comment_end?>
    </tip>
  </section>
</chapter>
